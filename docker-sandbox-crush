#!/bin/bash

set -e

print_usage() {
    echo "Usage: docker-sandbox-crush <command>"
    echo ""
    echo "Commands:"
    echo "  run    Run Crush CLI in Docker sandbox"
}

validate_docker() {
    # Check if Docker CLI is installed
    if ! command -v docker &> /dev/null; then
        echo "Error: docker CLI is not installed or not in PATH" >&2
        return 1
    fi

    # Check if Docker daemon is running and accessible
    if ! docker info &> /dev/null; then
        echo "Error: docker daemon is not running or not accessible" >&2
        return 1
    fi

    return 0
}

run_command() {
    # Validate Docker is available
    if ! validate_docker; then
        exit 1
    fi

    # TODO: Implement full run logic (US-002 through US-006)
    echo "Docker is available. Ready to run Crush CLI in sandbox."
}

# Main script logic
if [ $# -lt 1 ]; then
    print_usage >&2
    exit 1
fi

COMMAND="$1"

case "$COMMAND" in
    run)
        run_command
        ;;
    *)
        echo "Error: Unknown command: $COMMAND" >&2
        print_usage >&2
        exit 1
        ;;
esac
